# OperationQueue, DispatchQueue

: Operation과 OperationQueue는 iOS2에서 처음 소개됨

: Grand Central Dispatch는 iOS4에서 처음 소개됨

= 동시성을 지원하기 위해 작업 단위를 캡슐화하여 실행에 넘기는 동작을 하도록 설계됨



: Operation이 GCD 위에서 동작하게 설계함. Operation은 GCD를 상위 수준으로 추상화한 api라고 할 수 있음.

: GCD는 시스템의 유닉스 레벨의 수준에서 직접적으로 상호작용하는 저수준의 C api임. 

: Operation은 Objective-C api임.

= Operation은 보다 저수준에서 동작하는 GCD보다 상대적으로 느림



**<Operation의 이점>**

* Dependencies

  : Operation은 의존성을 제공함. 개발자가 일련의 작업에 순서를 정할 수 있다는 것을 의미하고 하나의 작업이 다른 작업에 의존성을 갖고 있다면 이 작업은 해당 작업들이 모두 끝난 후에 작업을 시작할 수 있음.

* Observable

  : Operation과 OperationQueue 클래스는 KVO를 통해 관찰될 수 있는 프로퍼티를 제공함. 작업들의 상태를 모니터링 할 수 있음.

* Pause, Cancel, Resume

  : 정지, 취소, 재시작 될 수 있음. GCD에 작업을 할당한다면 해당 작업에 대한 어떠한 통제권도 갖지 못한다. 이 관점에서 Operation이 보다 작업의 Life Cycle에 대한 유연함을 제공한다는 것을 알 수 있음. (작업을 대기열에 추가한 것 자체는 되돌릴 수 없음)

* Control

  : OperationQueue는 대기열에 들어갈 수 있는 작업의 숫자를 지정함으로써 동시에 수행될 수 있는 작업의 수를 지정할 수 있음. 이를 통해 동시에 실행되는 작업의 개수와 이들의 순서를 조작할 수 있음.



** 일반적으로 애플은 개발자들에게 보다 고수준의 추상화된 api를 사용할 것을 권장한다. 즉, Operation을 보다 권장하는 것임. 애플은 새로운 iOS 버전 출시마다 운영체제의 효율을 증가시키기 위해 프레임워크와 라이브러리를 최적화하는 작업을 수행한다. 이러한 작업은 보통 저수준의 api에 영향을 주곤 한다. 



** 어떠한 작업들의 순서를 지정해줄 필요가 있다면 Operation을 사용하는 것이 바람직함. 하지만 짧은 시간 안에 수십 개의 작업을 생성해야하는 경우에는 Operation의 내재된 오버헤드로 인한 성능 문제로 이어질 수 있음.



** GCD는 적은 양의 코드로도 같은 행위를 할 수 있음. 순서가 아예 없는 것은 아님. 기본적으로 FIFO 형태의 하나의 작업 대기열을 갖고 있기 때문에 들어온 순서대로 작업을 처리할 수 있음. 들어온 순서에 상관 없이 Concurrent하게 작업을 진행할 수도 있음. 
# Closure

* 코드의 블럭
* 일급 객체
* 전달인자, 변수, 상수 등으로 저장, 전달이 가능
* 매개변수, 반환 타입 생략가능
* return 키워드 생략 가능
* 축약된 전달인자 이름을 사용 가능



{ (매개변수들) -> 반환 타입 in 

​	실행 코드

}

>  `in` : 정의부와 실현부를 구분하기 위해 사용



* 클로저는 참조 타입이기 때문에 클로저의 본문이 인스턴스를 캡쳐할 때 클로저가 self를 캡쳐하게 되면서 강한 순환 참조가 발생할 수 있음
* 캡쳐(`capture`) : 클로저의 본문에서 인스턴스의 프로퍼티에 접근하거나 인스턴스의 메소드를 호출하는 것



## 클로저에서의 강한 순환 참조 해결법

* 클로저의 선언부에서 캡쳐 리스트(`capture list`)를 정의하는 것으로 해결할 수 있음
* 캡쳐 리스트는 클로저 본문에 하나 이상의 참조를 캡쳐할 때 사용하는 규칙을 정의함
* 강한 참조 대신 약한 참조나 미소유 참조로 선언해서 정의함
* 캡쳐 목록의 각 항목은 클래스 인스턴스에 참조(self)하거나 어떤 값으로 초기화된 변수(delegate = self.delegate)에 weak나 unowned 키워드로 연결됨
* 클로저와 인스턴스의 캡쳐가 항상 서로를 참조할 때, 클로저에서 캡쳐를 미소유(`unowned`) 참조로 정의하고, 항상 같은 시점에 메모리에서 해제됨. 캡쳐된 참조가 nil이 되지 않으면 미소유 참조로 하는 것이 좋음
* 캡쳐된 참조가 나중에 nil이 될 수 있다면 클로저에서 캡쳐를 약한(`weak`) 참조로 정의함. 약한 참조는 항상 옵셔널 타입이고, **참조하는 인스턴스가 메모리에서 해제될 때 nil이 됨**





















